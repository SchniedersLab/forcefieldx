<?xml version="1.0" encoding="UTF-8" ?>
<document
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://maven.apache.org/XDOC/2.0"
        xsi:schemaLocation="http://maven.apache.org/XDOC/2.0 http://maven.apache.org/xsd/xdoc-2.0.xsd">
    <properties>
        <title>Introduction</title>
        <author email="michael-schnieders@uiowa.edu">Michael J. Schnieders</author>
    </properties>
    <body>
        <section name="Introduction">
            <p>The Numerics module includes support for:</p>
            <ul>
                <li>1D, 2D and 3D FFTs that leverage SIMD vector instructions.</li>
                <li>Limited memory BFGS optimization</li>
                <li>b-Splines</li>
                <li>Erf and Erfc</li>
                <li>Tensor recursions</li>
            </ul>
            <subsection name="L-BFGS Optimization">
                <p>The limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) algorithm is appropriate for
                    large-scale multidimensional unconstrained optimization problems. It is derived from Robert
                    Dodier's Java translation of orignal FORTRAN code by Jorge Nocedal.
                </p>
            </subsection>
            <subsection name="Fast Fourier Transformation">
                <p>The FFT classes implement:</p>
                <ul>
                    <li>1D Real to Complex</li>
                    <li>1D Complex to Complex</li>
                    <li>3D Real to Complex</li>
                    <li>3D Complex to Complex</li>
                    <li>3D Real to Complex Convolutions</li>
                    <li>3D Complex to Complex Convolutions</li>
                </ul>
                <p>The 1D methods compute the FFT of real or complex, double precision data
                    of arbitrary length n using a mixed radix method that has special methods to handle
                    factors of [2, 3, 4, 5, 6, 7] and a general method for larger prime factors.
                </p>
                <p>The 3D methods are serial or SMP parallel. The convolutions are designed for the
                    reciprocal space portion of Particle Mesh Ewald summation.
                </p>
                <p>Selected timing results comparing FFTW and FFX on MacOS with an Apple M2 Max CPU
                    (FFTW 3.3.10) are shown below for 3D double precision C2C round-trip FFTs.
                </p>
                <table>
                    <tr>
                        <th>Size</th>
                        <th>Library</th>
                        <th>Threads</th>
                        <th>Operation</th>
                        <th>Time (sec)</th>
                    </tr>
                    <!-- 64 x 64 x 64 -->
                    <tr>
                        <td>
                            <b>64×64×64</b>
                        </td>
                        <td>FFTW</td>
                        <td>1</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.005549</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFTW</td>
                        <td>8</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.001469</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFX</td>
                        <td>8</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.001022</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFX</td>
                        <td>8</td>
                        <td>Convolution</td>
                        <td>0.000867</td>
                    </tr>
                    <!-- 128 x 128 x 128 -->
                    <tr>
                        <td>
                            <b>128×128×128</b>
                        </td>
                        <td>FFTW</td>
                        <td>1</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.056120</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFTW</td>
                        <td>8</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.010322</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFX</td>
                        <td>8</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.009983</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFX</td>
                        <td>8</td>
                        <td>Convolution</td>
                        <td>0.008273</td>
                    </tr>
                    <!-- 256 x 256 x 256 -->
                    <tr>
                        <td>
                            <b>256×256×256</b>
                        </td>
                        <td>FFTW</td>
                        <td>1</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.633118</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFTW</td>
                        <td>8</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.155233</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFX</td>
                        <td>8</td>
                        <td>Forward + Reverse FFT</td>
                        <td>0.106308</td>
                    </tr>
                    <tr>
                        <td><!-- Blank --></td>
                        <td>FFX</td>
                        <td>8</td>
                        <td>Convolution</td>
                        <td>0.083182</td>
                    </tr>
                </table>
                <p>Note that for FFX, the convolution operation is faster than the sum of individual Forward + Reverse
                    FFTs
                    due to eliminating two 3D matrix transpose operations.
                </p>
            </subsection>
        </section>
    </body>
</document>
